(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._loadingStyle=e,this._rootElement=document.body}var n,o;return n=t,(o=[{key:"show",value:function(){this._rootElement.classList.add(this._loadingStyle)}},{key:"hide",value:function(){this._rootElement.classList.remove(this._loadingStyle)}},{key:"_scheduleHide",value:function(e){var t=this;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){setTimeout((function(){return t.hide()}),e)})):setTimeout((function(){return t.hide()}),e)}},{key:"scheduleHide",value:function(){this._scheduleHide(500)}},{key:"scheduleDelayedHide",value:function(){this._scheduleHide(2e3)}},{key:"scheduleFallbackHide",value:function(){this._scheduleHide(12e3)}}])&&e(n.prototype,o),t}();function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o="#!/~/cart",i="!/~/cart",r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r="".concat(o,"/").concat(t,"="),a=n.hash,s=n.pathname;if(!a||a.length<=r.length){r="".concat(i,"/").concat(t,"=");var c=s.indexOf(r);if(s&&-1!==c)this.setCommandBody(r,s.substring(c));else{if(!Ecwid.isStorefrontV3||!Ecwid.isStorefrontV3()||!n.search)return;var l=new URLSearchParams(window.location.search);l.has(t)&&(this._commandBody=l.get(t))}}else this.setCommandBody(r,a)}var t,r;return t=e,(r=[{key:"hashPrefix",get:function(){return o}},{key:"pathPrefix",get:function(){return i}},{key:"hasBody",get:function(){return!!this._commandBody}},{key:"body",get:function(){return this._commandBody}},{key:"setCommandBody",value:function(e,t){0===t.indexOf(e)&&(this._commandBody=t.substring(e.length))}}])&&n(t.prototype,r),e}();function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"parse",value:function(e){try{return JSON.parse(e)}catch(t){console.error("Json parsing error",e,t)}}}],null&&a(t.prototype,null),n&&a(t,n),e}();function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"decode",value:function(e){var t=decodeURIComponent(e);try{var n=this._unescapeNonAsciiSymbols(atob(t));return s.parse(n)}catch(e){return console.log("Cart creation link is not in base64. Trying to parse just decoded link"),s.parse(t)}}},{key:"_unescapeNonAsciiSymbols",value:function(e){return decodeURIComponent(e)}}],null&&c(t.prototype,null),n&&c(t,n),e}();function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u="CART";new(function(){function e(n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n?(this._ecwid=n,this._parseRequest(o)&&(i&&xAffiliate(i),this._ecwid.isStorefrontV3&&this._ecwid.isStorefrontV3()||(this._indicator=new t(this._gotoCheckout?"shop-at-app-checkout-loading-style":"shop-at-app-loading-style"),this._restoreCart()))):console.log("ecwid module not found, skip loading")}var n,o;return n=e,(o=[{key:"_parseRequest",value:function(e){if(this._plainRequest=new r(e,window.location),this._plainRequest.hasBody){if(this._request=l.decode(this._plainRequest.body),this._productsArray=this._request&&this._request.products,this._productsArray&&Array.isArray(this._productsArray)&&0!==this._productsArray.length)return this._gotoCheckout=!0===this._request.gotoCheckout,this._profile=this._request.profile,!0;console.log("incorrect object passed "+this._plainRequest.body)}}},{key:"_restoreCart",value:function(){var e=this;this._indicator.show(),this._ecwid.OnAPILoaded.add((function(){e._tryExecuteRequest()})),this._ecwid.OnPageLoaded.add((function(t){t.type===u&&e._indicator.scheduleFallbackHide()}))}},{key:"_applyProfile",value:function(){this._profile&&(this._profile.address&&this._ecwid.Cart.setAddress(this._profile.address,(function(){return console.log("address applied")}),(function(e,t){return console.error(e+t)})),this._profile.billingAddress&&this._ecwid.Cart.setBillingAddress(this._profile.billingAddress,(function(){return console.log("billing address applied")}),(function(e,t){return console.error(e+t)})),this._profile.email&&this._ecwid.Cart.setCustomerEmail(this._profile.email,(function(){return console.log("email applied")}),(function(e,t){return console.error(e+t)})),this._profile.orderComments&&this._ecwid.Cart.setOrderComments(this._profile.orderComments,(function(){return console.log("order comments applied")}),(function(e,t){return console.error(e+t)})))}},{key:"_tryExecuteRequest",value:function(){var e=this;this._ecwid.Cart.clear(),this._applyProfile();var t=0;this._productsArray.forEach((function(n){n.callback=function(o,i){var r="adding ".concat(i?i.name:JSON.stringify(n),"  ").concat(o);o?console.log(r):console.error(r),t+=1,e._isAllProductsAdded(t)&&e._onAllProductsAdded()},e._ecwid.Cart.addProduct(n)})),this._cleanHistory(this._plainRequest.hashPrefix)}},{key:"_isAllProductsAdded",value:function(e){return e===this._productsArray.length}},{key:"_onAllProductsAdded",value:function(){var e=this;this._gotoCheckout&&this._ecwid.Cart.canGotoCheckout()?(this._ecwid.OnPageLoaded.add((function(t){t.type!==u&&e._indicator.hide()})),this._ecwid.Cart.gotoCheckout((function(){return e._indicator.scheduleDelayedHide()}))):this._indicator.scheduleHide()}},{key:"_cleanHistory",value:function(e){window.history.replaceState(null,null,e),this._ecwid.customHistoryStateHandler&&this._ecwid.customHistoryStateHandler(window.location.hash)}}])&&d(n.prototype,o),e}())(window.Ecwid,"create-from-shopapp","ShopApp"),new function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Ecwid=t,function(e,t){if(e){var n=function(){this.getSmartBanner=function(){var t=e.getAppPublicConfig("ecwid-shopapp"),n=(t=s.parse(t))&&t.branch_metrics;n&&function(e){var t='(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode banner closeBanner creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setIdentity track validateCode".split(" "), 0);\nbranch.init(\''+e.app_branch_key+"');\nbranch.banner({\nicon: '"+e.app_icon+"',\ntitle: '"+e.app_title+"',\ndescription: '"+e.app_description+"',\nopenAppButtonText: 'Open',\ndownloadAppButtonText: 'Get App', \nshowiOS:"+(null==e.showiOS||e.showiOS)+",\nshowAndroid:"+(null==e.showAndroid||e.showAndroid)+",\nshowDesktop:"+(null==e.showDesktop||e.showDesktop)+",\ncustomCSS: '"+(null==e.customCSS?"":e.customCSS)+"',}, {});",n=document.createElement("script");n.type="text/javascript",n.text=t,document.getElementsByTagName("head")[0].appendChild(n)}(n)}};e.OnAPILoaded.add((function(){try{for(var t=e.getInitializedWidgets(),o=0;o<t.length;o++)"ProductBrowser"==t[o]&&(new n).getSmartBanner()}catch(e){console.log("error",e)}}))}else console.log("ecwid module not found, skip loading")}(t)}(window.Ecwid)})();
//# sourceMappingURL=bundle.js.map